apiVersion: v1
kind: ConfigMap
metadata:
  name: litmus-grafana-provisioner
  namespace: monitoring
data:
  default.yaml: |-
    {
        "apiVersion": 1,
        "providers": [
            {
                "name": "Prometheus",
                "orgId": 1,
                "folder": "Services",
                "type": "file",
                "disableDeletion": false,
                "editable": true,
                "options": {
                    "path": "/var/lib/grafana/dashboards",
                    "foldersFromFilesStructure": true
                }
            }
        ]
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: litmus-grafana-dashboards
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  node_pod_metrics_dashboard.json: |-
    {"annotations":{"list":[{"$$hashKey":"object:137","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"iteration":1625413839827,"links":[],"panels":[{"collapsed":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{},"overrides":[]},"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":47,"panels":[],"title":"Litmus Chaos Chaos durations interleaved with Node Exporter & Kube-State Metrics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":10,"fillGradient":5,"gridPos":{"h":5,"w":12,"x":0,"y":1},"hiddenSeries":false,"id":75,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.0.4","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"expr":"litmuschaos_awaited_experiments","interval":"","legendFormat":"{{chaosresult_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos Experiments","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:517","format":"none","label":"CHAOS = TRUE","logBase":2,"max":"1","min":"0","show":true},{"$$hashKey":"object:518","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"cacheTimeout":null,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":5,"w":3,"x":12,"y":1},"id":67,"interval":null,"links":[],"maxDataPoints":100,"options":{"orientation":"horizontal","reduceOptions":{"calcs":["max"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"text":{}},"pluginVersion":"8.0.4","targets":[{"expr":"sum(litmuschaos_passed_experiments + litmuschaos_failed_experiments)","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","refId":"A","step":20}],"timeFrom":null,"timeShift":null,"title":"Total Experiments Run","type":"gauge"},{"cacheTimeout":null,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":5,"w":3,"x":15,"y":1},"id":69,"interval":null,"links":[],"maxDataPoints":100,"options":{"orientation":"horizontal","reduceOptions":{"calcs":["max"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"text":{}},"pluginVersion":"8.0.4","targets":[{"expr":"sum(litmuschaos_passed_experiments)","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","refId":"A","step":20}],"timeFrom":null,"timeShift":null,"title":"Passed Experiments","type":"gauge"},{"cacheTimeout":null,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":5,"w":3,"x":18,"y":1},"id":71,"interval":null,"links":[],"maxDataPoints":100,"options":{"orientation":"horizontal","reduceOptions":{"calcs":["max"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"text":{}},"pluginVersion":"8.0.4","targets":[{"expr":"sum(litmuschaos_failed_experiments)","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","refId":"A","step":20}],"title":"Failed Experiments","type":"gauge"},{"cacheTimeout":null,"datasource":"DS_PROMETHEUS","fieldConfig":{"defaults":{"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"none"},"overrides":[]},"gridPos":{"h":5,"w":3,"x":21,"y":1},"id":73,"interval":null,"links":[],"maxDataPoints":100,"options":{"orientation":"horizontal","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"text":{}},"pluginVersion":"8.0.4","targets":[{"expr":"sum(litmuschaos_awaited_experiments)","instant":true,"interval":"","intervalFactor":3,"legendFormat":"","refId":"A"}],"title":"Queued Experiments","type":"gauge"},{"datasource":"$datasource","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"cores","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"graph":false,"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":8,"x":0,"y":6},"id":64,"interval":"","options":{"graph":{},"legend":{"calcs":["mean","lastNotNull","max","min","sum"],"displayMode":"table","placement":"bottom"},"tooltip":{"mode":"single"}},"pluginVersion":"7.5.2","targets":[{"expr":"instance:node_cpu_utilisation:rate1m","interval":"","legendFormat":"\"{{instance}}\"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Chaos - Node - CPU Utilization","type":"timeseries"},{"datasource":"$datasource","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"Memory","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"graph":false,"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":8,"w":8,"x":8,"y":6},"id":65,"options":{"graph":{},"legend":{"calcs":["mean","lastNotNull","max","min","sum"],"displayMode":"table","placement":"bottom"},"tooltip":{"mode":"single"}},"pluginVersion":"7.5.2","targets":[{"expr":"instance:node_memory_utilisation:ratio","interval":"","legendFormat":"\"{{instance}}\"","refId":"B"}],"timeFrom":null,"timeShift":null,"title":"Chaos - Node - Memory Utilization","type":"timeseries"},{"datasource":"$datasource","description":"","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"bytes","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"graph":false,"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"decbytes"},"overrides":[]},"gridPos":{"h":8,"w":8,"x":16,"y":6},"id":76,"options":{"graph":{},"legend":{"calcs":["mean","lastNotNull","max","min","sum"],"displayMode":"table","placement":"bottom"},"tooltip":{"mode":"single"}},"pluginVersion":"7.5.2","targets":[{"exemplar":true,"expr":"sum(rate(node_network_receive_bytes_total[1m])) BY (instance)","interval":"","legendFormat":"\"{{instance}}\" (input)","refId":"B"},{"exemplar":true,"expr":"sum(rate(node_network_transmit_bytes_total[1m])) BY (instance)","hide":false,"interval":"","legendFormat":"\"{{instance}}\" (output)","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Chaos - Node - Network IN\/OUT","type":"timeseries"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":14,"w":8,"x":0,"y":14},"hiddenSeries":false,"id":62,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"connected","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.0.4","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"sum(rate(container_cpu_usage_seconds_total{container=\"app-sample\"}[5m])) by (pod)","interval":"","legendFormat":"\"{{pod}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Pod - CPU Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:535","format":"short","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:536","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$datasource","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":14,"w":8,"x":8,"y":14},"hiddenSeries":false,"id":63,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"connected","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.0.4","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"sum(container_memory_usage_bytes{container=\"app-sample\"}) by (pod)","interval":"","legendFormat":"\"{{pod}}\"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chaos - Pod - Memory Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:665","format":"bytes","label":"Memory","logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:666","format":"short","label":"CHAOS","logBase":2,"max":"1","min":"0","show":false}],"yaxis":{"align":false,"alignLevel":null}},{"datasource":"$datasource","description":"","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"bytes","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"graph":false,"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"decbytes"},"overrides":[]},"gridPos":{"h":14,"w":8,"x":16,"y":14},"id":77,"options":{"graph":{},"legend":{"calcs":["mean","lastNotNull","max","min","sum"],"displayMode":"table","placement":"bottom"},"tooltip":{"mode":"single"}},"pluginVersion":"7.5.2","targets":[{"exemplar":true,"expr":"sum(rate(container_network_receive_bytes_total{pod=~\"app-sample.+\"}[5m])) by (pod)","interval":"","legendFormat":"{{pod}} (input)","refId":"B"},{"exemplar":true,"expr":"sum(rate(container_network_transmit_bytes_total{pod=~\"app-sample.+\"}[5m])) by (pod)","hide":false,"interval":"","legendFormat":"{{pod}} (output)","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Chaos - Pod - Network IN\/OUT","type":"timeseries"}],"refresh":"5s","schemaVersion":30,"style":"dark","tags":[],"templating":{"list":[{"current":{"selected":false,"text":"DS_PROMETHEUS","value":"DS_PROMETHEUS"},"description":null,"error":null,"hide":0,"includeAll":false,"label":"","multi":false,"name":"datasource","options":[],"query":"prometheus","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"allValue":null,"current":{"isNone":true,"selected":false,"text":"None","value":""},"datasource":"$datasource","definition":"label_values(kube_pod_info, cluster)","description":null,"error":null,"hide":2,"includeAll":false,"label":null,"multi":false,"name":"cluster","options":[],"query":{"query":"label_values(kube_pod_info, cluster)","refId":"DS_PROMETHEUS-cluster-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"hidden":false,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"Node and Pod Chaos Metrics","uid":"nodepodmetrics","version":3}